{% if error %}
    <div class="h-100 border-dark border-1 border d-flex align-items-center justify-content-center">
        <div class="h4 text-danger">{{ error|raw }}</div>
    </div>
{% else %}
    <!-- Resources -->
    <script src="//cdn.amcharts.com/lib/5/index.js"></script>
    <script src="//cdn.amcharts.com/lib/5/xy.js"></script>
    <script src="//cdn.amcharts.com/lib/5/themes/Animated.js"></script>

    <!-- Styles -->
    <style>
        #chartdiv {
            width: 100%;
            max-width: 100%
        }
    </style>


    <!-- Chart code -->
    <script>
        am5.ready(function() {

// Create root element
// https://www.amcharts.com/docs/v5/getting-started/#Root_element
            var root = am5.Root.new("chartdiv");


// Set themes
// https://www.amcharts.com/docs/v5/concepts/themes/
            root.setThemes([
                am5themes_Animated.new(root)
            ]);


// Create chart
// https://www.amcharts.com/docs/v5/charts/xy-chart/
            var chart = root.container.children.push(am5xy.XYChart.new(root, {
                layout: root.verticalLayout,
                panX: true,
                panY: true,
                wheelX: "panX",
                wheelY: "zoomX",
                pinchZoomX:true
            }));


// Add cursor
// https://www.amcharts.com/docs/v5/charts/xy-chart/cursor/
            var cursor = chart.set("cursor", am5xy.XYCursor.new(root, {
                behavior: "none"
            }));
            cursor.lineY.set("visible", false);


// Create axes
// https://www.amcharts.com/docs/v5/charts/xy-chart/axes/
            var xAxis = chart.xAxes.push(am5xy.DateAxis.new(root, {
                maxDeviation: 0.2,
                baseInterval: {
                    timeUnit: "day",
                    count: 1
                },
                renderer: am5xy.AxisRendererX.new(root, {}),
                tooltip: am5.Tooltip.new(root, {})
            }));

            var yAxis = chart.yAxes.push(am5xy.ValueAxis.new(root, {
                renderer: am5xy.AxisRendererY.new(root, {})
            }));


// Add series
// https://www.amcharts.com/docs/v5/charts/xy-chart/series/
            var Visits = chart.series.push(am5xy.LineSeries.new(root, {
                name: "Визиты",
                xAxis: xAxis,
                yAxis: yAxis,
                valueYField: "visits",
                valueXField: "date",
                tooltip: am5.Tooltip.new(root, {
                    labelText: "{valueY}"
                })
            }));

            var Views = chart.series.push(am5xy.LineSeries.new(root, {
                name: "Просмотры",
                xAxis: xAxis,
                yAxis: yAxis,
                valueYField: "pageviews",
                valueXField: "date",
                tooltip: am5.Tooltip.new(root, {
                    labelText: "{valueY}"
                })
            }));

            var Users = chart.series.push(am5xy.LineSeries.new(root, {
                name: "Уникальные посетители",
                xAxis: xAxis,
                yAxis: yAxis,
                valueYField: "users",
                valueXField: "date",
                tooltip: am5.Tooltip.new(root, {
                    labelText: "{valueY}"
                })
            }));

// Set data
            let data = {{ data|raw }};
            Visits.data.setAll(data);
            Views.data.setAll(data);
            Users.data.setAll(data);

            // Add legend
            var legend = chart.children.push(am5.Legend.new(root, {}));
            legend.data.setAll(chart.series.values);

// Make stuff animate on load
// https://www.amcharts.com/docs/v5/concepts/animations/
            Visits.appear(1000);
            Views.appear(1000);
            Users.appear(1000);
            chart.appear(1000, 100);

        }); // end am5.ready()
    </script>

    <!-- HTML -->
    <div class="h-100" id="chartdiv"></div>
{% endif %}
